title: mysql生成唯一的索引数据
date: 2010-04-29
author: denglf
layout: post
categories: [Mysql]
tags: [connection id, index, Mysql]
---
部署好一个数据库服务器之后一般会随机生成一些数据做一些测试，在插入数据的过程中，随机生成的数据不能使索引重复，否则就会出错。相信大家都有很多很好的解决方案。
<!--more-->
比如用`rand()`生成一个随机数，并加上当前时间的毫秒数作为后缀，这样插入的数据都是唯一的。这对单个连接进程是没有问题的，如果用多个进程来插入数据，就有可能出现这个数据相同的情况。

可幸的是进程号`PID`可以解决这个问题，虽然`PID`被不断重用，但是对同一时刻的两个进程，它们的`PID`绝不会相同，因此对于一组正在执行的进程而言，给定的`PID`值一定是唯一的。可以运用这一点生成唯一的索引值。

`rand()+系统时间+PID`在多个进程之间是唯一的。

如何查看`PID`呢，用下面的语句：

```mysql
select connection_id();
```
